---
title: "Explore"
author: "William Fisher"
date: "11/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ProjectTemplate)
load.project()
```

Reading in data
```{r}
Clean_data = read_rds(path = "data/clean_data.Rds")
```

New variable
```{r}
Clean_data$CPIA_cuts = cut_width(x = Clean_data$CPIA_mean, width = 0.5)
```

Summary statistics
```{r}
summary(Clean_data)
```

Summary Graph - CPIA
```{r}
ggplot(
  data = Clean_data, 
  mapping = aes(
    x = CPIA_Mean
  )
) +
  geom_histogram(binwidth = 0.2) +
  theme_minimal() +
  labs(title = "Histogram of mean CPIA ratings") +
  xlab("CPIA mean") +
  ylab("Obervations")

ggsave(filename = "graphs/Summary/Mean_CPIA.jpeg", 
       device = "jpeg", 
       height = 8, 
       width = 16)
```

CPIA over time
```{r}
ggplot(
  data = Clean_data, 
  mapping = aes(
    x = Year, y = CPIA_Mean, colour = Country
  )
) +
  geom_smooth(se = FALSE) +
  theme_minimal() +
  labs(title = "Histogram of mean CPIA ratings") +
  xlab("Year") +
  ylab("Mean of CPIA")

ggsave(filename = "graphs/Summary/Mean_CPIA_by_Country.jpeg", 
       device = "jpeg", 
       height = 8, 
       width = 16)
```

Summary Graph - GDP
```{r}
ggplot(
  data = Clean_data, 
  mapping = aes(
    x = Year, y = GDP, colour = Country
  )
) +
  geom_smooth(se = FALSE) +
  theme_minimal() +
  labs(title = "Histogram of mean CPIA ratings") +
  xlab("Year") +
  ylab("GDP per capita")

ggsave(filename = "graphs/Summary/GDP_by_Country.jpeg", 
       device = "jpeg", 
       height = 8, 
       width = 16)
```

Summary Graph - GDP
```{r}
ggplot(
  data = Clean_data, 
  mapping = aes(
    x = log(Aid), y = log(GDP)
  )
) +
  geom_jitter(mapping = aes(colour = Country)) +
  geom_smooth() +
  theme_minimal() +
  labs(title = "Aid against GDP") +
  xlab("Aid") +
  ylab("GDP")

ggsave(filename = "graphs/Summary/GDP_Aid.jpeg", 
       device = "jpeg", 
       height = 8, 
       width = 16)
```

Summary Graph - GDP
```{r}
ggplot(
  data = Clean_data, 
  mapping = aes(
    x = log(Aid), y = log(GDP_growth)
  )
) +
  geom_jitter(mapping = aes(colour = Country)) +
  geom_smooth() +
  theme_minimal() +
  labs(title = "Aid against GDP") +
  xlab("Log Aid") +
  ylab("Log GDP Growth")

ggsave(filename = "graphs/Summary/GDP_Aid.jpeg", 
       device = "jpeg", 
       height = 8, 
       width = 16)
```


Saving data
```{r}
Clean_data %>% 
  write_rds("data/clean_data_1.Rds")
```
